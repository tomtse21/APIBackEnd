{
  "version": 3,
  "sources": ["../../controllers/auth.ts"],
  "sourcesContent": ["import passport from \"koa-passport\";\nimport { BasicStrategy } from \"passport-http\";\nimport { RouterContext } from \"koa-router\";\n\nimport * as users  from '../models/users';\n\nconst verifyPassword = (user: any, password: string) => {\n  return user.password === password;\n}\n\npassport.use(new BasicStrategy(async (username, password, done) => {\n  // Replace this with your own authentication logic\n  /*if (username === \"admin\" && password === \"password\") {\n    done(null, { username: \"admin\" });\n  } else {\n    done(null, false);\n  } */\n  let result: any[] = [];\n  try {\n    result = await users.findByUsername(username);\n  } catch (error) {\n    console.error(`Error during authentication for user ${username}: ${error}`);\n    done(null, false);\n  }\n  if(result.length) {\n    const user = result[0];\n    if(verifyPassword(user, password)) {\n      done(null, {user: user});\n    } else {\n      console.log(`Password incorrect for ${username}`);\n      done(null, false);\n    }\n  } else {\n    console.log(`No user found with username ${username}`);\n    done(null, false);\n  }\n}));\n\nexport const basicAuth = async (ctx: RouterContext, next: any) => {\n  await passport.authenticate(\"basic\", { session: false })(ctx, next);\n  if(ctx.status == 401)\n  {\n    ctx.body = {\n      message: 'you are not authorized'\n    };\n  // } else {\n  //   ctx.body = {\n  //     message: 'you are passed'\n  //   };\n  }\n} \n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAqB;AACrB,2BAA8B;AAG9B,YAAwB;AAExB,MAAM,iBAAiB,CAAC,MAAW,aAAqB;AACtD,SAAO,KAAK,aAAa;AAC3B;AAEA,oBAAAA,QAAS,IAAI,IAAI,mCAAc,OAAO,UAAU,UAAU,SAAS;AAOjE,MAAI,SAAgB,CAAC;AACrB,MAAI;AACF,aAAS,MAAM,MAAM,eAAe,QAAQ;AAAA,EAC9C,SAAS,OAAP;AACA,YAAQ,MAAM,wCAAwC,aAAa,OAAO;AAC1E,SAAK,MAAM,KAAK;AAAA,EAClB;AACA,MAAG,OAAO,QAAQ;AAChB,UAAM,OAAO,OAAO;AACpB,QAAG,eAAe,MAAM,QAAQ,GAAG;AACjC,WAAK,MAAM,EAAC,KAAU,CAAC;AAAA,IACzB,OAAO;AACL,cAAQ,IAAI,0BAA0B,UAAU;AAChD,WAAK,MAAM,KAAK;AAAA,IAClB;AAAA,EACF,OAAO;AACL,YAAQ,IAAI,+BAA+B,UAAU;AACrD,SAAK,MAAM,KAAK;AAAA,EAClB;AACF,CAAC,CAAC;AAEK,MAAM,YAAY,OAAO,KAAoB,SAAc;AAChE,QAAM,oBAAAA,QAAS,aAAa,SAAS,EAAE,SAAS,MAAM,CAAC,EAAE,KAAK,IAAI;AAClE,MAAG,IAAI,UAAU,KACjB;AACE,QAAI,OAAO;AAAA,MACT,SAAS;AAAA,IACX;AAAA,EAKF;AACF;",
  "names": ["passport"]
}
